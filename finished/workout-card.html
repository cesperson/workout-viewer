<link rel="import" href="../components/polymer/polymer.html">
<link rel="import" href="../components/core-icon-button/core-icon-button.html">
<link rel="import" href="set-row.html">

<polymer-element name="workout-card" attributes="sets">
    <template>
        <style>
            :host {
                display: block;
                position: relative;
                background-color: white;
                padding: 20px;
                width: 100%;
                /*font-size: 1.2rem;*/
                font-weight: 300;
            }
            .card-header {
                margin-bottom: 10px;
            }
            polyfill-next-selector { content: ".card-header h2"; }
            .card-header ::content h2 {
                margin: 0;
                font-size: 1.8rem;
                font-weight: 300;
            }
            polyfill-next-selector { content: ".card-header img"; }
            .card-header ::content img {
                width: 70px;
                border-radius: 50%;
                margin: 10px;
            }
            core-icon-button {
                position: absolute;
                top: 3px;
                right: 3px;
            }
            core-icon-button {
                fill: #636363;
            }
            :host([favorite]) core-icon-button {
                fill: #da4336;
            }
            h3 {
                margin: 1rem 0 1rem 0;
                font-weight: normal;
                text-transform: uppercase;
                color: #777;
            }
            h3.warmups {
                font-size: .8rem;

            }
            h3.working {

            }
        </style>

        <!--<div class="card-header" layout horizontal center>-->
        <!--</div>-->

        <h2>Squats</h2>

        <!--<h3 class="warmups">Warmups</h3>-->
        <template repeat="{{ set in sets | onlyType('squat') | warmups }}">
            <set-row class="{{ set.warmwork }}"
                     type="{{ set.type }}"
                     weight="{{ set.weight }}"
                     warmwork="{{ set.warmwork }}"
                     reps="{{ set.reps }}">
            </set-row>
        </template>

        <h3 class="working">Working</h3>
        <template repeat="{{ set in sets | onlyType('squat') | working }}">
            <set-row class="{{ set.warmwork }}"
                     type="{{ set.type }}"
                     weight="{{ set.weight }}"
                     reps="{{ set.reps }}">
            </set-row>
        </template>

    </template>
    <script>
        Polymer('workout-card', {
            publish: {
                favorite: {
                    value: false,
                    reflect: true
                }
            },
            created: function () {

            },
            onlyType: function (value, type) {
                var typeSet = [];
                value.forEach(function(element, index) {
                    if (element.type === type) {
                        typeSet.push(element);
                    }
                })
                return typeSet;
            },
            working: function (value) {
                var working = [];
                value.forEach(function(element, index) {
                    if (element.warmwork === 'working') {
                        working.push(element);
                    }
                })
                return working;
            },
            warmups: function (value) {
                var warmups = [];
                value.forEach(function(element, index) {
                    if (element.warmwork === 'warmup') {
                        warmups.push(element);
                    }
                })
                return warmups;
            },
            favoriteTapped: function(event, detail, sender) {
                this.favorite = !this.favorite;
                this.fire('favorite-tap');
            }
        });
    </script>
</polymer-element>
