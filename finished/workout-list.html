<link rel="import" href="../components/polymer/polymer.html">
<!--<link rel="import" href="../post-service/post-service.html">-->
<link rel="import" href="../post-service/workout-service.html">
<!--<link rel="import" href="post-card.html">-->
<link rel="import" href="workout-card.html">
<link rel="import" href="set-menu.html">

<polymer-element name="workout-list" attributes="show">
    <template>
        <style>
            :host {
                display: block;
                width: 100%;
            }
            workout-card {
                margin-bottom: 30px;
            }
            .workout {
                border-bottom: 1px solid #ccc;
                width: 100%;
                margin-bottom: 30px;
            }
        </style>

        <workout-service id="service" workouts="{{ workouts }}"></workout-service>

        <!-- on-tap-submit uses the broadcast tap-submit from set-menu -->
        <div layout vertical center on-tap-submit="{{ alertalert }}">

            <div class="workout" hidden?="{{show !== 'today' }}">
                <set-menu></set-menu>

                <template repeat="{{type in types}}">
                    <workout-card
                            edit="true"
                            sets="{{ newsets }}"
                            active="true"
                            type="{{ type }}">
                    </workout-card>
                </template>

            </div>

            <template repeat="{{workout in workouts}}" class="workout">

                <div class="workout" hidden?="{{show === 'today' }}">
                    <template repeat="{{type in types}}">
                        <workout-card
                                edit="false"
                                sets="{{workout.sets}}"
                                active="false"
                                type="{{type}}">
                        </workout-card>
                    </template>
                </div>

            </template>

        </div>

    </template>

    <script>
        Polymer('workout-list', {
            alertalert: function (event) {
                this.newsets.push(event.detail)
            },
            created: function () {
                this.types = ["squat", "deadlift", "chin"];

                this.newtwo = [
                    { "type": "chin",
                        "weight": 25,
                        "reps": 6,
                        "warmwork": "working"
                    },
                    {
                        "type": "chin",
                        "weight": 10,
                        "reps": 8,
                        "warmwork": "working"
                    },
                    {
                        "type": "chin",
                        "weight": "body",
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "squat",
                        "weight": 175,
                        "reps": 6,
                        "warmwork": "working"
                    },
                    { "type": "squat",
                        "weight": 160,
                        "reps": 10,
                        "warmwork": "working"
                    },
                    {
                        "type": "squat",
                        "weight": 45,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "squat",
                        "weight": 95,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "squat",
                        "weight": 115,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "squat",
                        "weight": 135,
                        "reps": 3,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "deadlift",
                        "weight": 175,
                        "reps": 6,
                        "warmwork": "working"
                    },
                    { "type": "deadlift",
                        "weight": 160,
                        "reps": 10,
                        "warmwork": "working"
                    },
                    {
                        "type": "deadlift",
                        "weight": 45,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "deadlift",
                        "weight": 95,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "deadlift",
                        "weight": 115,
                        "reps": 5,
                        "warmwork": "warmup"
                    },
                    {
                        "type": "deadlift",
                        "weight": 135,
                        "reps": 3,
                        "warmwork": "warmup"
                    }
                ]
            },
            publish: {
                newsets: {
                    value: [
                        {
                            "type": "squat",
                            "weight": 179,
                            "reps": 6,
                            "warmwork": "working"
                        }
                    ],
                    reflect: true
                }
            },
            handleFavorite: function(event, detail, sender) {
                var post = sender.templateInstance.model.post;
                this.$.service.setFavorite(post.uid, post.favorite);
            }
        });
    </script>
</polymer-element>
